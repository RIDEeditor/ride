<html>
    <head>
        <title>Ruby on Rails IDE</title>
        <script>window.$ = window.jQuery = require("jquery");</script>
        <script>require("./js/jquery-ui/jquery-ui.js");</script>
        <script src="js/jstree.js"></script>
        <script src="js/underscore.js"></script>
        <script src="js/tabs.js"></script>
        <script src="ace-builds/src/ace.js"></script>
        <script src="ace-builds/src/ext-themelist.js"></script>
        <script src="ace-builds/src/ext-modelist.js"></script>
        <script src="ace-builds/src/ext-statusbar.js"></script>
        <link href="http://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="css/tabs.css">
        <link rel="stylesheet" type="text/css" href="css/jstree.css">
    </head>
    <body>


        <div class="panel-container">

            <div class="panel-left">
                <div id="treecontainer">
                    <div id="treeview"></div>
                </div>
            </div>

            <div class="splitter">
            </div>

            <div class="panel-right">
                <div class="tabs-shell tabs">
                    <div class="tabs">
                        <button class='new'>+</button>
                    </div>
                </div>

                <div id="code"></div>
            </div>
        </div>


        <footer>
            <div id="statusBar"></div>
        </footer>
        
    </body>

<script>
    var TabsList = {}; // Holds all tabs that have been created
    var tab_bar; // Represents the top tab bar
    var editor;
    $(document).ready(function() {
        $('#treeview').jstree({ 'core' : {
            'data' : [
                'Simple root node',
                {
                    'text' : 'Root node 2',
                    'state' : {
                        'opened' : true,
                        'selected' : true
                    },
                    'children' : [
                        { 'text' : 'Child 1' },
                        'Child 2'
                    ]
                }
            ]
        } });

        // Setup the tabs bar
        tab_bar = new Tabs({
            shell: $('.tabs-shell'),
            minWidth: 45,
            maxWidth: 180
        });

        editor = ace.edit('code');
        editor.setValue("");
        editor.setTheme("ace/theme/monokai");

        // Define what the 'new tab' button does
        $('.new').on('click', function(ev) {
            new Tab();
        });

        new Tab("untitled");

        var StatusBar = ace.require("ace/ext/statusbar").StatusBar;
        // Create a simple selection status indicator
        var statusBar = new StatusBar(editor, document.getElementById("statusBar"));


        $(".panel-left").resizable({
            handleSelector: ".splitter",
            resizeHeight: false
        });


    });

    // Load ace extras
    var AceDocument = ace.require("ace/document");
    var EditSession = ace.require("ace/edit_session");
    var UndoManager = ace.require("ace/undomanager");

    /**
    * Switches focus to the tab with the given id
    */
    var switchTab = function(id) {
        var doc = TabsList[id];
        editor.setSession(doc.aceSession);
        editor.focus();
        current_editor = doc;
    }


</script>

<!-- setup the menus -->
<script src="js/menu.js"></script>
<script src="js/editor.js"></script>

<style>
    html,body {
        background-color: #161712;
        height: 100%;
        padding: 0;
        margin: 0;
        overflow: auto;
    }

    footer{
        float: bottom;
        height: 2%;
    }

    .tabs-shell {
        width: 100%;
    }


    #code {
        height: 100%;
        width: 100%;
    }

    #statusBar {
        background-color: white;
        position: fixed;
        bottom: 0;
        width: 100%;
    }

    .ace_status-indicator{
        float: right;
        padding-right: 50px;
    }

    button.new {
      padding: 5px;
      margin-left: 15px;
      background: transparent;
      color: #e1e3e1;
      border: none;
      font-size: 18px;
      font-weight: bold;
    }


.page-container {
  margin: 20px;
}


/* horizontal panel*/

.panel-container {
  display: flex;
  flex-direction: row;
  border: 1px solid silver;
  overflow: hidden;
  
  /* avoid browser level touch actions */
  xtouch-action: none;
}

.panel-left {
  flex: 0 0 auto;
  /* only manually resize */
  padding: 0px;
  width: 300px;
  min-height: 200px;
  min-width: 150px;
  white-space: nowrap;
  background: #838383;
  color: white;
}

.splitter {
  flex: 0 0 auto;
  width: 18px;  
  background: url(https://raw.githubusercontent.com/RickStrahl/jquery-resizable/master/assets/vsizegrip.png) center center no-repeat #535353;
  min-height: 200px;
  cursor: col-resize;  
}

.panel-right {
  flex: 1 1 auto;
  /* resizable */
  padding: 0px;
  width: 100%;
  min-height: 200px;
  min-width: 200px;
  background: #eee;
}

label {
  font-size: 1.2em;
  display: block;
  font-weight: bold;
  margin: 0px 0 0px;
}

pre {
  margin: 0px;
  padding: 0px;
  background: #eee;
  border: 1px solid silver;
  border-radius: 4px;
  overflow: auto;
}

</style>

